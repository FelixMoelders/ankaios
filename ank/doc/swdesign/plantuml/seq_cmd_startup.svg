<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="726px" preserveAspectRatio="none" style="width:1206px;height:726px;background:#FFFFFF;" version="1.1" viewBox="0 0 1206 726" width="1206px" zoomAndPan="magnify"><defs/><g><rect fill="#EEEEEE" height="714.5313" style="stroke:#D3D3D3;stroke-width:0.5;" width="1011" x="21" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="91" x="481" y="18.0669">Ankaios Ank</text><rect fill="#EEEEEE" height="714.5313" style="stroke:#D3D3D3;stroke-width:0.5;" width="134" x="1064" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1076" y="18.0669">Ankaios Server</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="43.5" x2="43.5" y1="101.4297" y2="663.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="43.5" x2="43.5" y1="663.7266" y2="704.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="43.5" x2="43.5" y1="704.5313" y2="714.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="149.5" x2="149.5" y1="101.4297" y2="663.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="149.5" x2="149.5" y1="663.7266" y2="704.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="149.5" x2="149.5" y1="704.5313" y2="714.5313"/><rect fill="#FFFFFF" height="533.1641" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="144.5" y="130.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="144.5" x2="144.5" y1="130.5625" y2="663.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="154.5" x2="154.5" y1="130.5625" y2="663.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="144.5" x2="154.5" y1="130.5625" y2="130.5625"/><rect fill="#FFFFFF" height="10" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="144.5" y="704.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="144.5" x2="144.5" y1="704.5313" y2="714.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="154.5" x2="154.5" y1="704.5313" y2="714.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="144.5" x2="154.5" y1="714.5313" y2="714.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="209.5" x2="209.5" y1="181.6953" y2="663.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="209.5" x2="209.5" y1="663.7266" y2="704.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="209.5" x2="209.5" y1="704.5313" y2="714.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="289" x2="289" y1="242.125" y2="663.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="289" x2="289" y1="663.7266" y2="704.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="289" x2="289" y1="704.5313" y2="714.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="590" x2="590" y1="273.4219" y2="663.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="590" x2="590" y1="663.7266" y2="704.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="590" x2="590" y1="704.5313" y2="714.5313"/><rect fill="#FFFFFF" height="293.4453" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="585" y="370.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="585" y1="370.2813" y2="663.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="595" x2="595" y1="370.2813" y2="663.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="595" y1="370.2813" y2="370.2813"/><rect fill="#FFFFFF" height="10" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="585" y="704.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="585" y1="704.5313" y2="714.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="595" x2="595" y1="704.5313" y2="714.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="595" y1="714.5313" y2="714.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="826" x2="826" y1="378.2813" y2="663.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="826" x2="826" y1="663.7266" y2="704.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="826" x2="826" y1="704.5313" y2="714.5313"/><rect fill="#FFFFFF" height="172.2891" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="821" y="491.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="821" x2="821" y1="491.4375" y2="663.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="831" x2="831" y1="491.4375" y2="663.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="821" x2="831" y1="491.4375" y2="491.4375"/><rect fill="#FFFFFF" height="10" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="821" y="704.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="821" x2="821" y1="704.5313" y2="714.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="831" x2="831" y1="704.5313" y2="714.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="821" x2="831" y1="714.5313" y2="714.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="967" x2="967" y1="499.4375" y2="663.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="967" x2="967" y1="663.7266" y2="704.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="967" x2="967" y1="704.5313" y2="714.5313"/><rect fill="#FFFFFF" height="51.1328" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="962" y="612.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="962" x2="962" y1="612.5938" y2="663.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="972" x2="972" y1="612.5938" y2="663.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="962" x2="972" y1="612.5938" y2="612.5938"/><rect fill="#FFFFFF" height="10" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="962" y="704.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="962" x2="962" y1="704.5313" y2="714.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="972" x2="972" y1="704.5313" y2="714.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="962" x2="972" y1="714.5313" y2="714.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1131" x2="1131" y1="101.4297" y2="663.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1131" x2="1131" y1="663.7266" y2="704.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1131" x2="1131" y1="704.5313" y2="714.5313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="25" y="98.1279">user</text><ellipse cx="43.5" cy="33.6328" fill="#E3E3E3" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M43.5,41.6328 L43.5,68.6328 M30.5,49.6328 L56.5,49.6328 M43.5,68.6328 L30.5,83.6328 M43.5,68.6328 L56.5,83.6328 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46" x="126.5" y="70.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="133.5" y="90.1279">Main</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116" x="1073" y="70.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="1080" y="90.1279">Ankaios Server</text><polygon fill="#181818" points="132.5,126.5625,142.5,130.5625,132.5,134.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="43.5" x2="138.5" y1="130.5625" y2="130.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="50.5" y="125.4966">a command</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1194" x="5" y="159.1289"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1199" y1="159.1289" y2="159.1289"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1199" y1="162.1289" y2="162.1289"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="73" x="565.5" y="148.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54" x="571.5" y="164.6294">startup</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="30" x="194.5" y="181.6953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="16" x="201.5" y="201.6904">Cli</text><polygon fill="#181818" points="182.5,183.6953,192.5,187.6953,182.5,191.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="154.5" x2="188.5" y1="187.6953" y2="187.6953"/><polygon fill="#181818" points="197.5,230.125,207.5,234.125,197.5,238.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="154.5" x2="203.5" y1="234.125" y2="234.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="161.5" y="229.0591">parse</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="234.5" y="242.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="241.5" y="262.1201">CliCommands</text><polygon fill="#181818" points="222.5,259.2578,232.5,263.2578,222.5,267.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="154.5" x2="228.5" y1="263.2578" y2="263.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19" x="161.5" y="258.1919">init</text><rect fill="#E3E3E3" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="144" x="518" y="273.4219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="543.5" y="293.417">&lt;&lt;thread&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="525" y="309.7139">Middleware (gRPC)</text><line style="stroke:#181818;stroke-width:1.0;" x1="516" x2="506" y1="294.5547" y2="290.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="516" x2="506" y1="294.5547" y2="298.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="289" x2="517" y1="294.5547" y2="294.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205" x="296" y="289.4888">create and start in a new thread</text><line style="stroke:#181818;stroke-width:1.0;" x1="590" x2="637" y1="357.2813" y2="357.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="637" x2="637" y1="357.2813" y2="370.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="596" x2="637" y1="370.2813" y2="370.2813"/><polygon fill="#181818" points="606,366.2813,596,370.2813,606,374.2813" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="602" y="337.0825">start and endless loop</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217" x="602" y="352.2153">trying to (re)connect to the server</text><rect fill="#E3E3E3" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="131" x="760.5" y="378.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="787.5" y="398.2764">&lt;&lt;task&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="767.5" y="414.5732">Listen to Ankaios</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="804" y="430.8701">Server</text><line style="stroke:#181818;stroke-width:1.0;" x1="758.5" x2="748.5" y1="399.4141" y2="395.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="758.5" x2="748.5" y1="399.4141" y2="403.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="595" x2="759.5" y1="399.4141" y2="399.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="602" y="394.3481">create an async task</text><line style="stroke:#181818;stroke-width:1.0;" x1="826" x2="873" y1="478.4375" y2="478.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="873" x2="873" y1="478.4375" y2="491.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="832" x2="873" y1="491.4375" y2="491.4375"/><polygon fill="#181818" points="842,487.4375,832,491.4375,842,495.4375" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="838" y="458.2388">start listening for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="838" y="473.3716">execution requests</text><rect fill="#E3E3E3" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122" x="906" y="499.4375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="928.5" y="519.4326">&lt;&lt;task&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="913" y="535.7295">Listen to Agent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="937" y="552.0264">Manager</text><line style="stroke:#181818;stroke-width:1.0;" x1="904" x2="894" y1="520.5703" y2="516.5703"/><line style="stroke:#181818;stroke-width:1.0;" x1="904" x2="894" y1="520.5703" y2="524.5703"/><line style="stroke:#181818;stroke-width:1.0;" x1="595" x2="905" y1="520.5703" y2="520.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="602" y="515.5044">create an async task</text><line style="stroke:#181818;stroke-width:1.0;" x1="967" x2="1014" y1="599.5938" y2="599.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="1014" x2="1014" y1="599.5938" y2="612.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="973" x2="1014" y1="612.5938" y2="612.5938"/><polygon fill="#181818" points="983,608.5938,973,612.5938,983,616.5938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="979" y="579.395">start listening for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="979" y="594.5278">state change requests</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1194" x="5" y="641.1602"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1199" y1="641.1602" y2="641.1602"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1199" y1="644.1602" y2="644.1602"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="92" x="556" y="630.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="73" x="562" y="646.6606">command</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="88" x="543.25" y="687.937">implementation</text><!--MD5=[e90192c4cf8861124f18b207082e4de2]
@startuml seq_cmd_startup
!include ../../../../doc/plantuml/clean.skin

box "Ankaios Ank"
    actor "user" as user
    participant Main as main
    participant "Cli" as cli
    participant "CliCommands" as cli_commands
    participant "<<thread>>\nMiddleware (gRPC)" as grpc_client
    participant "<<task>>\nListen to Ankaios\nServer" as listen_to_server
    participant "<<task>>\nListen to Agent \nManager" as listen_to_manager
end box

box "Ankaios Server"
    participant "Ankaios Server" as server
end box

user-> main ++ : a command

== startup ==

main -> cli ** 
main -> cli : parse 
main -> cli_commands ** : init
cli_commands ->> grpc_client ** : create and start in a new thread

grpc_client -> grpc_client ++: start and endless loop \ntrying to (re)connect to the server
grpc_client ->> listen_to_server **: create an async task
listen_to_server -> listen_to_server ++: start listening for \nexecution requests

grpc_client ->> listen_to_manager **: create an async task
listen_to_manager -> listen_to_manager ++: start listening for \nstate change requests

== command ==

... implementation ...

@enduml

@startuml seq_cmd_startup
skinparam monochrome true
skinparam guillemet true
skinparam style strictuml
hide empty members
hide empty methods

skinparam class {
    BorderColor<<logical entity>> grey
    FontColor<<logical entity>> grey
    StereotypeFontColor<<logical entity>> grey
}

skinparam sequenceBox {
    BorderColor #LightGrey
    BackgroundColor #EEEEEE
    FontColor #777777
}

skinparam BoxPadding 10

skinparam note {
    BackgroundColor #FFFFFF
}

skinparam nodesep 30
skinparam ranksep 30

!pragma teoz true

box "Ankaios Ank"
    actor "user" as user
    participant Main as main
    participant "Cli" as cli
    participant "CliCommands" as cli_commands
    participant "<<thread>>\nMiddleware (gRPC)" as grpc_client
    participant "<<task>>\nListen to Ankaios\nServer" as listen_to_server
    participant "<<task>>\nListen to Agent \nManager" as listen_to_manager
end box

box "Ankaios Server"
    participant "Ankaios Server" as server
end box

user-> main ++ : a command

== startup ==

main -> cli ** 
main -> cli : parse 
main -> cli_commands ** : init
cli_commands ->> grpc_client ** : create and start in a new thread

grpc_client -> grpc_client ++: start and endless loop \ntrying to (re)connect to the server
grpc_client ->> listen_to_server **: create an async task
listen_to_server -> listen_to_server ++: start listening for \nexecution requests

grpc_client ->> listen_to_manager **: create an async task
listen_to_manager -> listen_to_manager ++: start listening for \nstate change requests

== command ==

... implementation ...

@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>