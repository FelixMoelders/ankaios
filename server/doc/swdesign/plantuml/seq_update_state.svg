<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="731px" preserveAspectRatio="none" style="width:1198px;height:731px;" version="1.1" viewBox="0 0 1198 731" width="1198px" zoomAndPan="magnify"><defs/><g><rect fill="#EEEEEE" height="709.9844" style="stroke: #D3D3D3; stroke-width: 1.0;" width="692" x="19" y="4"/><text fill="#777777" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="310" y="16.0669">Ankaios Server</text><rect fill="#EEEEEE" height="709.9844" style="stroke: #D3D3D3; stroke-width: 1.0;" width="276" x="733" y="4"/><text fill="#777777" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="115" x="813.5" y="16.0669">Ankaios Agents</text><rect fill="#FFFFFF" height="197.9297" style="stroke: #383838; stroke-width: 1.0;" width="10" x="74" y="158.9922"/><rect fill="#FFFFFF" height="14" style="stroke: #383838; stroke-width: 1.0;" width="10" x="74" y="696.9844"/><rect fill="#FFFFFF" height="522.8594" style="stroke: #383838; stroke-width: 1.0;" width="10" x="265" y="188.125"/><rect fill="#FFFFFF" height="58.2656" style="stroke: #383838; stroke-width: 1.0;" width="10" x="270" y="255.5234"/><rect fill="#FFFFFF" height="286.7969" style="stroke: #383838; stroke-width: 1.0;" width="10" x="448" y="342.9219"/><rect fill="#FFFFFF" height="49.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="766" y="80.7266"/><rect fill="#FFFFFF" height="300.7969" style="stroke: #383838; stroke-width: 1.0;" width="10" x="766" y="410.1875"/><rect fill="#FFFFFF" height="28" style="stroke: #383838; stroke-width: 1.0;" width="10" x="771" y="447.3203"/><rect fill="#FFFFFF" height="168.3984" style="stroke: #383838; stroke-width: 1.0;" width="10" x="966" y="542.5859"/><rect fill="#FFFFFF" height="28" style="stroke: #383838; stroke-width: 1.0;" width="10" x="971" y="579.7188"/><rect fill="#FFFFFF" height="385.3281" style="stroke: #000000; stroke-width: 2.0;" width="1173" x="13" y="275.5234"/><rect fill="#FFFFFF" height="118.3984" style="stroke: #000000; stroke-width: 2.0;" width="640" x="336" y="371.9219"/><rect fill="#FFFFFF" height="118.3984" style="stroke: #000000; stroke-width: 2.0;" width="840" x="336" y="504.3203"/><rect fill="#FFFFFF" height="31.1328" style="stroke: none; stroke-width: 1.0;" width="1173" x="13" y="629.7188"/><line style="stroke: #383838; stroke-width: 1.0;" x1="79" x2="79" y1="70.7266" y2="80.7266"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="79" x2="79" y1="80.7266" y2="108.7266"/><line style="stroke: #383838; stroke-width: 1.0;" x1="79" x2="79" y1="108.7266" y2="719.9844"/><line style="stroke: #383838; stroke-width: 1.0;" x1="270" x2="270" y1="70.7266" y2="80.7266"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="270" x2="270" y1="80.7266" y2="108.7266"/><line style="stroke: #383838; stroke-width: 1.0;" x1="270" x2="270" y1="108.7266" y2="719.9844"/><line style="stroke: #383838; stroke-width: 1.0;" x1="453" x2="453" y1="70.7266" y2="80.7266"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="453" x2="453" y1="80.7266" y2="108.7266"/><line style="stroke: #383838; stroke-width: 1.0;" x1="453" x2="453" y1="108.7266" y2="719.9844"/><line style="stroke: #383838; stroke-width: 1.0;" x1="638" x2="638" y1="70.7266" y2="80.7266"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="638" x2="638" y1="80.7266" y2="108.7266"/><line style="stroke: #383838; stroke-width: 1.0;" x1="638" x2="638" y1="108.7266" y2="719.9844"/><line style="stroke: #383838; stroke-width: 1.0;" x1="771" x2="771" y1="70.7266" y2="80.7266"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="771" x2="771" y1="80.7266" y2="108.7266"/><line style="stroke: #383838; stroke-width: 1.0;" x1="771" x2="771" y1="108.7266" y2="719.9844"/><line style="stroke: #383838; stroke-width: 1.0;" x1="971" x2="971" y1="70.7266" y2="80.7266"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="971" x2="971" y1="80.7266" y2="108.7266"/><line style="stroke: #383838; stroke-width: 1.0;" x1="971" x2="971" y1="108.7266" y2="719.9844"/><rect fill="#F8F8F8" height="46.5938" style="stroke: #383838; stroke-width: 1.5;" width="112" x="23" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="32.5" y="43.1279">&lt;&lt;thread&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="30" y="59.4248">AnkaiosServer</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="94" x="223" y="39.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="230" y="59.4248">ServerState</text><rect fill="#F8F8F8" height="46.5938" style="stroke: #383838; stroke-width: 1.5;" width="214" x="346" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="406.5" y="43.1279">&lt;&lt;thread&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="200" x="353" y="59.4248">GRPCCommunicationsServer</text><rect fill="#F8F8F8" height="46.5938" style="stroke: #383838; stroke-width: 1.5;" width="137" x="570" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="592" y="43.1279">&lt;&lt;thread&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="123" x="577" y="59.4248">tonic gRPC server</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="68" x="737" y="39.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="744" y="59.4248">Agent 1</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="68" x="937" y="39.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="944" y="59.4248">Agent 2</text><rect fill="#FFFFFF" height="197.9297" style="stroke: #383838; stroke-width: 1.0;" width="10" x="74" y="158.9922"/><rect fill="#FFFFFF" height="14" style="stroke: #383838; stroke-width: 1.0;" width="10" x="74" y="696.9844"/><rect fill="#FFFFFF" height="522.8594" style="stroke: #383838; stroke-width: 1.0;" width="10" x="265" y="188.125"/><rect fill="#FFFFFF" height="58.2656" style="stroke: #383838; stroke-width: 1.0;" width="10" x="270" y="255.5234"/><rect fill="#FFFFFF" height="286.7969" style="stroke: #383838; stroke-width: 1.0;" width="10" x="448" y="342.9219"/><rect fill="#FFFFFF" height="49.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="766" y="80.7266"/><rect fill="#FFFFFF" height="300.7969" style="stroke: #383838; stroke-width: 1.0;" width="10" x="766" y="410.1875"/><rect fill="#FFFFFF" height="28" style="stroke: #383838; stroke-width: 1.0;" width="10" x="771" y="447.3203"/><rect fill="#FFFFFF" height="168.3984" style="stroke: #383838; stroke-width: 1.0;" width="10" x="966" y="542.5859"/><rect fill="#FFFFFF" height="28" style="stroke: #383838; stroke-width: 1.0;" width="10" x="971" y="579.7188"/><line style="stroke: #383838; stroke-width: 1.0;" x1="638.5" x2="648.5" y1="129.8594" y2="125.8594"/><line style="stroke: #383838; stroke-width: 1.0;" x1="638.5" x2="648.5" y1="129.8594" y2="133.8594"/><line style="stroke: #383838; stroke-width: 1.0;" x1="638.5" x2="770" y1="129.8594" y2="129.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="655.5" y="124.7935">UpdateState</text><line style="stroke: #383838; stroke-width: 1.0;" x1="84" x2="94" y1="158.9922" y2="154.9922"/><line style="stroke: #383838; stroke-width: 1.0;" x1="84" x2="94" y1="158.9922" y2="162.9922"/><line style="stroke: #383838; stroke-width: 1.0;" x1="84" x2="637.5" y1="158.9922" y2="158.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="101" y="153.9263">UpdateState</text><polygon fill="#383838" points="253,184.125,263,188.125,253,192.125" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="84" x2="259" y1="188.125" y2="188.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="91" y="183.0591">update state</text><line style="stroke: #383838; stroke-width: 1.0;" x1="275" x2="322" y1="242.5234" y2="242.5234"/><line style="stroke: #383838; stroke-width: 1.0;" x1="322" x2="322" y1="242.5234" y2="255.5234"/><line style="stroke: #383838; stroke-width: 1.0;" x1="281" x2="322" y1="255.5234" y2="255.5234"/><polygon fill="#383838" points="291,251.5234,281,255.5234,291,259.5234" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="287" y="207.1919">create ExecutionRequest</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="287" y="222.3247">from comparison of new</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="287" y="237.4575">and old CurrentState</text><path d="M13,275.5234 L77,275.5234 L77,282.5234 L67,292.5234 L13,292.5234 L13,275.5234 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="385.3281" style="stroke: #000000; stroke-width: 2.0;" width="1173" x="13" y="275.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="28" y="288.5903">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="79" x="92" y="287.7339">[State valid]</text><line style="stroke: #383838; stroke-width: 1.0;" x1="84" x2="94" y1="313.7891" y2="309.7891"/><line style="stroke: #383838; stroke-width: 1.0;" x1="84" x2="94" y1="313.7891" y2="317.7891"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="84" x2="264" y1="313.7891" y2="313.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="101" y="308.7231">ExecutionRequest</text><line style="stroke: #383838; stroke-width: 1.0;" x1="446" x2="436" y1="342.9219" y2="338.9219"/><line style="stroke: #383838; stroke-width: 1.0;" x1="446" x2="436" y1="342.9219" y2="346.9219"/><line style="stroke: #383838; stroke-width: 1.0;" x1="84" x2="447" y1="342.9219" y2="342.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="91" y="337.856">send ExecutionRequests</text><line style="stroke: #383838; stroke-width: 1.0;" x1="79" x2="89" y1="356.9219" y2="352.9219"/><line style="stroke: #383838; stroke-width: 1.0;" x1="79" x2="89" y1="356.9219" y2="360.9219"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="79" x2="447" y1="356.9219" y2="356.9219"/><path d="M336,371.9219 L406,371.9219 L406,378.9219 L396,388.9219 L336,388.9219 L336,371.9219 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="118.3984" style="stroke: #000000; stroke-width: 2.0;" width="640" x="336" y="371.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="351" y="384.9888">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="214" x="421" y="384.1323">[ExuectionsRequests for Agent 1]</text><line style="stroke: #383838; stroke-width: 1.0;" x1="764" x2="754" y1="410.1875" y2="406.1875"/><line style="stroke: #383838; stroke-width: 1.0;" x1="764" x2="754" y1="410.1875" y2="414.1875"/><line style="stroke: #383838; stroke-width: 1.0;" x1="458" x2="765" y1="410.1875" y2="410.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="465" y="405.1216">send ExecutionRequests</text><line style="stroke: #383838; stroke-width: 1.0;" x1="781" x2="823" y1="439.3203" y2="439.3203"/><line style="stroke: #383838; stroke-width: 1.0;" x1="823" x2="823" y1="439.3203" y2="452.3203"/><line style="stroke: #383838; stroke-width: 1.0;" x1="782" x2="823" y1="452.3203" y2="452.3203"/><polygon fill="#383838" points="792,448.3203,782,452.3203,792,456.3203" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="788" y="434.2544">execute ExecutionRequests</text><path d="M336,504.3203 L406,504.3203 L406,511.3203 L396,521.3203 L336,521.3203 L336,504.3203 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="118.3984" style="stroke: #000000; stroke-width: 2.0;" width="840" x="336" y="504.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="351" y="517.3872">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="214" x="421" y="516.5308">[ExuectionsRequests for Agent 2]</text><line style="stroke: #383838; stroke-width: 1.0;" x1="964" x2="954" y1="542.5859" y2="538.5859"/><line style="stroke: #383838; stroke-width: 1.0;" x1="964" x2="954" y1="542.5859" y2="546.5859"/><line style="stroke: #383838; stroke-width: 1.0;" x1="458" x2="965" y1="542.5859" y2="542.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="465" y="537.52">send ExecutionRequests</text><line style="stroke: #383838; stroke-width: 1.0;" x1="981" x2="1023" y1="571.7188" y2="571.7188"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1023" x2="1023" y1="571.7188" y2="584.7188"/><line style="stroke: #383838; stroke-width: 1.0;" x1="982" x2="1023" y1="584.7188" y2="584.7188"/><polygon fill="#383838" points="992,580.7188,982,584.7188,992,588.7188" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="988" y="566.6528">execute ExecutionRequests</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="1186" y1="630.7188" y2="630.7188"/><line style="stroke: #383838; stroke-width: 1.0;" x1="79" x2="89" y1="652.8516" y2="648.8516"/><line style="stroke: #383838; stroke-width: 1.0;" x1="79" x2="89" y1="652.8516" y2="656.8516"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="79" x2="264" y1="652.8516" y2="652.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="96" y="647.7856">UpdateStateError</text><line style="stroke: #383838; stroke-width: 1.0;" x1="79" x2="126" y1="683.9844" y2="683.9844"/><line style="stroke: #383838; stroke-width: 1.0;" x1="126" x2="126" y1="683.9844" y2="696.9844"/><line style="stroke: #383838; stroke-width: 1.0;" x1="85" x2="126" y1="696.9844" y2="696.9844"/><polygon fill="#383838" points="95,692.9844,85,696.9844,95,700.9844" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="91" y="678.9185">listen for incoming requests</text><!--MD5=[8dd72ff98d189bff5c5990176a5a1eba]
@startuml seq_update_state
skinparam monochrome true
skinparam guillemet true
skinparam style strictuml
hide empty members
hide empty methods

skinparam class {
    BorderColor<<logical entity>> grey
    FontColor<<logical entity>> grey
    StereotypeFontColor<<logical entity>> grey
}

skinparam sequenceBox {
    BorderColor #LightGrey
    BackgroundColor #EEEEEE
    FontColor #777777
}

skinparam BoxPadding 10

skinparam note {
    BackgroundColor #FFFFFF
}

skinparam nodesep 30
skinparam ranksep 30

box "Ankaios Server"
participant "<<thread>>\nAnkaiosServer" as server
participant "ServerState" as server_state
participant "<<thread>>\nGRPCCommunicationsServer" as grpc_server
participant "<<thread>>\ntonic gRPC server" as tonic_server
end box


box "Ankaios Agents"
participant "Agent 1" as agent1
participant "Agent 2" as agent2
end box

activate agent1

...
agent1 ->> tonic_server- -: UpdateState
tonic_server ->> server++: UpdateState
server -> server_state++: update state
server_state -> server_state++- -: create ExecutionRequest\nfrom comparison of new\nand old CurrentState
alt State valid
server_state - ->> server- -: ExecutionRequest
server ->> grpc_server++: send ExecutionRequests
grpc_server - ->> server
deactivate server
opt ExuectionsRequests for Agent 1
grpc_server ->> agent1++:send ExecutionRequests
agent1 -> agent1++- -: execute ExecutionRequests
deactivate agent1
end
opt ExuectionsRequests for Agent 2
grpc_server ->> agent2++:send ExecutionRequests
agent2 -> agent2++- -: execute ExecutionRequests
deactivate agent2
end
deactivate grpc_server
else
server_state - ->> server: UpdateStateError
end
server -> server++: listen for incoming requests


@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 17.0.9+9-Debian-1deb12u1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>