<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1084px" preserveAspectRatio="none" style="width:1039px;height:1084px;" version="1.1" viewBox="0 0 1039 1084" width="1039px" zoomAndPan="magnify"><defs/><g><rect fill="#EEEEEE" height="1062.6953" style="stroke: #D3D3D3; stroke-width: 1.0;" width="820" x="19" y="4"/><text fill="#777777" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="374" y="16.0669">Ankaios Server</text><rect fill="#EEEEEE" height="1062.6953" style="stroke: #D3D3D3; stroke-width: 1.0;" width="121" x="890" y="4"/><text fill="#777777" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="897" y="16.0669">Ankaios Agent</text><rect fill="#FFFFFF" height="976.9688" style="stroke: #383838; stroke-width: 1.0;" width="10" x="41" y="86.7266"/><rect fill="#FFFFFF" height="935.7695" style="stroke: #383838; stroke-width: 1.0;" width="10" x="46" y="127.9258"/><rect fill="#FFFFFF" height="889.5703" style="stroke: #383838; stroke-width: 1.0;" width="10" x="51" y="174.125"/><rect fill="#FFFFFF" height="28" style="stroke: #383838; stroke-width: 1.0;" width="10" x="56" y="1012.6953"/><rect fill="#FFFFFF" height="699.7109" style="stroke: #383838; stroke-width: 1.0;" width="10" x="287" y="275.8516"/><rect fill="#FFFFFF" height="644.1172" style="stroke: #383838; stroke-width: 1.0;" width="10" x="292" y="331.4453"/><rect fill="#FFFFFF" height="449.3203" style="stroke: #383838; stroke-width: 1.0;" width="10" x="297" y="503.1094"/><rect fill="#FFFFFF" height="34.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="302" y="717.3672"/><rect fill="#FFFFFF" height="734.1719" style="stroke: #383838; stroke-width: 1.0;" width="10" x="497" y="218.2578"/><rect fill="#FFFFFF" height="30" style="stroke: #383838; stroke-width: 1.0;" width="10" x="502" y="413.8438"/><rect fill="#FFFFFF" height="277.1953" style="stroke: #383838; stroke-width: 1.0;" width="10" x="502" y="675.2344"/><rect fill="#FFFFFF" height="163.7969" style="stroke: #383838; stroke-width: 1.0;" width="10" x="507" y="788.6328"/><rect fill="#FFFFFF" height="493.4531" style="stroke: #383838; stroke-width: 1.0;" width="10" x="761.5" y="547.2422"/><rect fill="#FFFFFF" height="334.4609" style="stroke: #383838; stroke-width: 1.0;" width="10" x="766.5" y="617.9688"/><rect fill="#FFFFFF" height="732.25" style="stroke: #383838; stroke-width: 1.0;" width="10" x="945.5" y="331.4453"/><rect fill="#FFFFFF" height="90.3984" style="stroke: #383838; stroke-width: 1.0;" width="10" x="950.5" y="862.0313"/><rect fill="#FFFFFF" height="15" style="stroke: #383838; stroke-width: 1.0;" width="10" x="955.5" y="937.4297"/><rect fill="#FFFFFF" height="704.25" style="stroke: #000000; stroke-width: 2.0;" width="1014" x="13" y="351.4453"/><rect fill="#FFFFFF" height="76.2656" style="stroke: #000000; stroke-width: 2.0;" width="632" x="385" y="375.5781"/><rect fill="#FFFFFF" height="61.3984" style="stroke: #000000; stroke-width: 2.0;" width="632" x="385" y="808.6328"/><rect fill="#FFFFFF" height="61.3984" style="stroke: #000000; stroke-width: 2.0;" width="632" x="385" y="884.0313"/><rect fill="#FFFFFF" height="103.2656" style="stroke: none; stroke-width: 1.0;" width="1014" x="13" y="952.4297"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="46" x2="46" y1="70.7266" y2="1072.6953"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="292" x2="292" y1="283.5156" y2="1072.6953"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="502" x2="502" y1="225.9219" y2="1072.6953"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="766" x2="766" y1="554.9063" y2="1072.6953"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="950" x2="950" y1="70.7266" y2="1072.6953"/><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="46" x="23" y="39.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="30" y="59.4248">Main</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="113" x="894" y="39.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="901" y="59.4248">Ankaios Agent</text><rect fill="#FFFFFF" height="976.9688" style="stroke: #383838; stroke-width: 1.0;" width="10" x="41" y="86.7266"/><rect fill="#FFFFFF" height="935.7695" style="stroke: #383838; stroke-width: 1.0;" width="10" x="46" y="127.9258"/><rect fill="#FFFFFF" height="889.5703" style="stroke: #383838; stroke-width: 1.0;" width="10" x="51" y="174.125"/><rect fill="#FFFFFF" height="28" style="stroke: #383838; stroke-width: 1.0;" width="10" x="56" y="1012.6953"/><rect fill="#FFFFFF" height="699.7109" style="stroke: #383838; stroke-width: 1.0;" width="10" x="287" y="275.8516"/><rect fill="#FFFFFF" height="644.1172" style="stroke: #383838; stroke-width: 1.0;" width="10" x="292" y="331.4453"/><rect fill="#FFFFFF" height="449.3203" style="stroke: #383838; stroke-width: 1.0;" width="10" x="297" y="503.1094"/><rect fill="#FFFFFF" height="34.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="302" y="717.3672"/><rect fill="#FFFFFF" height="734.1719" style="stroke: #383838; stroke-width: 1.0;" width="10" x="497" y="218.2578"/><rect fill="#FFFFFF" height="30" style="stroke: #383838; stroke-width: 1.0;" width="10" x="502" y="413.8438"/><rect fill="#FFFFFF" height="277.1953" style="stroke: #383838; stroke-width: 1.0;" width="10" x="502" y="675.2344"/><rect fill="#FFFFFF" height="163.7969" style="stroke: #383838; stroke-width: 1.0;" width="10" x="507" y="788.6328"/><rect fill="#FFFFFF" height="493.4531" style="stroke: #383838; stroke-width: 1.0;" width="10" x="761.5" y="547.2422"/><rect fill="#FFFFFF" height="334.4609" style="stroke: #383838; stroke-width: 1.0;" width="10" x="766.5" y="617.9688"/><rect fill="#FFFFFF" height="732.25" style="stroke: #383838; stroke-width: 1.0;" width="10" x="945.5" y="331.4453"/><rect fill="#FFFFFF" height="90.3984" style="stroke: #383838; stroke-width: 1.0;" width="10" x="950.5" y="862.0313"/><rect fill="#FFFFFF" height="15" style="stroke: #383838; stroke-width: 1.0;" width="10" x="955.5" y="937.4297"/><polygon fill="#383838" points="29,82.7266,39,86.7266,29,90.7266" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="3" x2="35" y1="86.7266" y2="86.7266"/><line style="stroke: #383838; stroke-width: 1.0;" x1="51" x2="98" y1="114.9258" y2="114.9258"/><line style="stroke: #383838; stroke-width: 1.0;" x1="98" x2="98" y1="114.9258" y2="127.9258"/><line style="stroke: #383838; stroke-width: 1.0;" x1="57" x2="98" y1="127.9258" y2="127.9258"/><polygon fill="#383838" points="67,123.9258,57,127.9258,67,131.9258" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="63" y="109.8599">load startup config</text><path d="M194,99.7266 L194,139.7266 L402,139.7266 L402,109.7266 L392,99.7266 L194,99.7266 " fill="#FFFFFF" style="stroke: #383838; stroke-width: 1.0;"/><path d="M392,99.7266 L392,109.7266 L402,109.7266 L392,99.7266 " fill="#FFFFFF" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="200" y="116.7935">Empty state is loaded,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="200" y="131.9263">if the startup config is empty.</text><line style="stroke: #383838; stroke-width: 1.0;" x1="56" x2="103" y1="161.125" y2="161.125"/><line style="stroke: #383838; stroke-width: 1.0;" x1="103" x2="103" y1="161.125" y2="174.125"/><line style="stroke: #383838; stroke-width: 1.0;" x1="62" x2="103" y1="174.125" y2="174.125"/><polygon fill="#383838" points="72,170.125,62,174.125,72,178.125" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="68" y="156.0591">create communication channels</text><line style="stroke: #383838; stroke-width: 1.0;" x1="393" x2="383" y1="208.2578" y2="204.2578"/><line style="stroke: #383838; stroke-width: 1.0;" x1="393" x2="383" y1="208.2578" y2="212.2578"/><line style="stroke: #383838; stroke-width: 1.0;" x1="61" x2="394" y1="208.2578" y2="208.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="68" y="203.1919">start</text><rect fill="#F8F8F8" height="46.5938" style="stroke: #383838; stroke-width: 1.5;" width="214" x="395" y="187.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="455.5" y="207.1201">&lt;&lt;thread&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="200" x="402" y="223.417">GRPCCommunicationsServer</text><line style="stroke: #383838; stroke-width: 1.0;" x1="234" x2="224" y1="265.8516" y2="261.8516"/><line style="stroke: #383838; stroke-width: 1.0;" x1="234" x2="224" y1="265.8516" y2="269.8516"/><line style="stroke: #383838; stroke-width: 1.0;" x1="61" x2="235" y1="265.8516" y2="265.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="68" y="260.7856">start with startup config</text><rect fill="#F8F8F8" height="46.5938" style="stroke: #383838; stroke-width: 1.5;" width="112" x="236" y="244.7188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="245.5" y="264.7139">&lt;&lt;thread&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="243" y="281.0107">AnkaiosServer</text><line style="stroke: #383838; stroke-width: 1.0;" x1="297" x2="344" y1="318.4453" y2="318.4453"/><line style="stroke: #383838; stroke-width: 1.0;" x1="344" x2="344" y1="318.4453" y2="331.4453"/><line style="stroke: #383838; stroke-width: 1.0;" x1="303" x2="344" y1="331.4453" y2="331.4453"/><polygon fill="#383838" points="313,327.4453,303,331.4453,313,335.4453" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="309" y="313.3794">validate startup config</text><path d="M13,351.4453 L77,351.4453 L77,358.4453 L67,368.4453 L13,368.4453 L13,351.4453 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="704.25" style="stroke: #000000; stroke-width: 2.0;" width="1014" x="13" y="351.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="28" y="364.5122">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="135" x="92" y="363.6558">[startup config valid]</text><path d="M385,375.5781 L462,375.5781 L462,382.5781 L452,392.5781 L385,392.5781 L385,375.5781 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="76.2656" style="stroke: #000000; stroke-width: 2.0;" width="632" x="385" y="375.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="400" y="388.645">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="477" y="387.7886">[per agent]</text><polygon fill="#383838" points="523,409.8438,513,413.8438,523,417.8438" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="517" x2="944.5" y1="413.8438" y2="413.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="529" y="408.7778">agent hello (name)</text><line style="stroke: #383838; stroke-width: 1.0;" x1="302" x2="349" y1="490.1094" y2="490.1094"/><line style="stroke: #383838; stroke-width: 1.0;" x1="349" x2="349" y1="490.1094" y2="503.1094"/><line style="stroke: #383838; stroke-width: 1.0;" x1="308" x2="349" y1="503.1094" y2="503.1094"/><polygon fill="#383838" points="318,499.1094,308,503.1094,318,507.1094" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="314" y="469.9106">start listening for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="314" y="485.0435">state change commands</text><line style="stroke: #383838; stroke-width: 1.0;" x1="696" x2="686" y1="537.2422" y2="533.2422"/><line style="stroke: #383838; stroke-width: 1.0;" x1="696" x2="686" y1="537.2422" y2="541.2422"/><line style="stroke: #383838; stroke-width: 1.0;" x1="507" x2="697" y1="537.2422" y2="537.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="514" y="532.1763">spawn gRPC server thread</text><rect fill="#F8F8F8" height="46.5938" style="stroke: #383838; stroke-width: 1.5;" width="137" x="698" y="516.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="720" y="536.1045">&lt;&lt;thread&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="123" x="705" y="552.4014">tonic gRPC server</text><line style="stroke: #383838; stroke-width: 1.0;" x1="771.5" x2="818.5" y1="604.9688" y2="604.9688"/><line style="stroke: #383838; stroke-width: 1.0;" x1="818.5" x2="818.5" y1="604.9688" y2="617.9688"/><line style="stroke: #383838; stroke-width: 1.0;" x1="777.5" x2="818.5" y1="617.9688" y2="617.9688"/><polygon fill="#383838" points="787.5,613.9688,777.5,617.9688,787.5,621.9688" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="783.5" y="584.77">start listening for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="783.5" y="599.9028">state change commands</text><line style="stroke: #383838; stroke-width: 1.0;" x1="507" x2="554" y1="662.2344" y2="662.2344"/><line style="stroke: #383838; stroke-width: 1.0;" x1="554" x2="554" y1="662.2344" y2="675.2344"/><line style="stroke: #383838; stroke-width: 1.0;" x1="513" x2="554" y1="675.2344" y2="675.2344"/><polygon fill="#383838" points="523,671.2344,513,675.2344,523,679.2344" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="519" y="642.0356">start listening for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="523" y="657.1685">execution commands</text><line style="stroke: #383838; stroke-width: 1.0;" x1="307" x2="354" y1="704.3672" y2="704.3672"/><line style="stroke: #383838; stroke-width: 1.0;" x1="354" x2="354" y1="704.3672" y2="717.3672"/><line style="stroke: #383838; stroke-width: 1.0;" x1="313" x2="354" y1="717.3672" y2="717.3672"/><polygon fill="#383838" points="323,713.3672,313,717.3672,323,721.3672" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="319" y="699.3013">calculate execution request</text><line style="stroke: #383838; stroke-width: 1.0;" x1="500" x2="490" y1="751.5" y2="747.5"/><line style="stroke: #383838; stroke-width: 1.0;" x1="500" x2="490" y1="751.5" y2="755.5"/><line style="stroke: #383838; stroke-width: 1.0;" x1="307" x2="501" y1="751.5" y2="751.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="314" y="746.4341">send execution request</text><line style="stroke: #383838; stroke-width: 1.0;" x1="512" x2="559" y1="775.6328" y2="775.6328"/><line style="stroke: #383838; stroke-width: 1.0;" x1="559" x2="559" y1="775.6328" y2="788.6328"/><line style="stroke: #383838; stroke-width: 1.0;" x1="518" x2="559" y1="788.6328" y2="788.6328"/><polygon fill="#383838" points="528,784.6328,518,788.6328,528,792.6328" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="524" y="770.5669">find concerned agents</text><path d="M385,808.6328 L462,808.6328 L462,815.6328 L452,825.6328 L385,825.6328 L385,808.6328 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="61.3984" style="stroke: #000000; stroke-width: 2.0;" width="632" x="385" y="808.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="400" y="821.6997">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="477" y="820.8433">[for each agent]</text><line style="stroke: #383838; stroke-width: 1.0;" x1="948.5" x2="938.5" y1="862.0313" y2="858.0313"/><line style="stroke: #383838; stroke-width: 1.0;" x1="948.5" x2="938.5" y1="862.0313" y2="866.0313"/><line style="stroke: #383838; stroke-width: 1.0;" x1="517" x2="949.5" y1="862.0313" y2="862.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="524" y="841.8325">send execution request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="524" y="856.9653">with workload list</text><path d="M385,884.0313 L462,884.0313 L462,891.0313 L452,901.0313 L385,901.0313 L385,884.0313 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="61.3984" style="stroke: #000000; stroke-width: 2.0;" width="632" x="385" y="884.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="400" y="897.0981">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="142" x="477" y="896.2417">[for each other agent]</text><line style="stroke: #383838; stroke-width: 1.0;" x1="953.5" x2="943.5" y1="937.4297" y2="933.4297"/><line style="stroke: #383838; stroke-width: 1.0;" x1="953.5" x2="943.5" y1="937.4297" y2="941.4297"/><line style="stroke: #383838; stroke-width: 1.0;" x1="517" x2="954.5" y1="937.4297" y2="937.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="524" y="917.231">send execution request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="524" y="932.3638">with list of workload states</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="1027" y1="953.4297" y2="953.4297"/><line style="stroke: #383838; stroke-width: 1.0;" x1="61" x2="71" y1="975.5625" y2="971.5625"/><line style="stroke: #383838; stroke-width: 1.0;" x1="61" x2="71" y1="975.5625" y2="979.5625"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="61" x2="291" y1="975.5625" y2="975.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="78" y="970.4966">startup config error</text><line style="stroke: #383838; stroke-width: 1.0;" x1="61" x2="108" y1="999.6953" y2="999.6953"/><line style="stroke: #383838; stroke-width: 1.0;" x1="108" x2="108" y1="999.6953" y2="1012.6953"/><line style="stroke: #383838; stroke-width: 1.0;" x1="67" x2="108" y1="1012.6953" y2="1012.6953"/><polygon fill="#383838" points="77,1008.6953,67,1012.6953,77,1016.6953" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="73" y="994.6294">Graceful shutdown</text><line style="stroke: #383838; stroke-width: 2.0;" x1="757.5" x2="775.5" y1="1038.6953" y2="1056.6953"/><line style="stroke: #383838; stroke-width: 2.0;" x1="757.5" x2="775.5" y1="1056.6953" y2="1038.6953"/><line style="stroke: #383838; stroke-width: 2.0;" x1="493" x2="511" y1="1038.6953" y2="1056.6953"/><line style="stroke: #383838; stroke-width: 2.0;" x1="493" x2="511" y1="1056.6953" y2="1038.6953"/><line style="stroke: #383838; stroke-width: 2.0;" x1="283" x2="301" y1="1038.6953" y2="1056.6953"/><line style="stroke: #383838; stroke-width: 2.0;" x1="283" x2="301" y1="1056.6953" y2="1038.6953"/><line style="stroke: #383838; stroke-width: 2.0;" x1="37" x2="55" y1="1038.6953" y2="1056.6953"/><line style="stroke: #383838; stroke-width: 2.0;" x1="37" x2="55" y1="1056.6953" y2="1038.6953"/><!--MD5=[6c8f4b77bcf1076a0c3f89c657553c68]
@startuml seq_startup
skinparam monochrome true
skinparam guillemet true
skinparam style strictuml
hide empty members
hide empty methods

skinparam class {
    BorderColor<<logical entity>> grey
    FontColor<<logical entity>> grey
    StereotypeFontColor<<logical entity>> grey
}

skinparam sequenceBox {
    BorderColor #LightGrey
    BackgroundColor #EEEEEE
    FontColor #777777
}

skinparam BoxPadding 10

skinparam note {
    BackgroundColor #FFFFFF
}

skinparam nodesep 30
skinparam ranksep 30

box "Ankaios Server"
participant Main as main
participant "<<thread>>\nAnkaiosServer" as server


participant "<<thread>>\nGRPCCommunicationsServer" as grpc_server
participant "<<thread>>\ntonic gRPC server" as tonic_server
end box

box "Ankaios Agent"
    participant "Ankaios Agent" as agent
end box

-> main ++
main -> main ++- -: load startup config
note right: Empty state is loaded,\nif the startup config is empty.
main -> main ++- -: create communication channels
main ->> grpc_server ** : start
activate grpc_server
main ->> server **: start with startup config
activate server
server -> server++: validate startup config
alt startup config valid
activate agent
loop per agent
    agent -> grpc_server ++: agent hello (name)
    deactivate grpc_server
end

activate server
server -> server ++: start listening for \nstate change commands

grpc_server ->> tonic_server **: spawn gRPC server thread
activate tonic_server
tonic_server -> tonic_server ++- -: start listening for \nstate change commands

grpc_server -> grpc_server ++- -: start listening for\n execution commands 

server -> server ++: calculate execution request

server ->> grpc_server - -++: send execution request

grpc_server -> grpc_server ++: find concerned agents

loop for each agent
    grpc_server ->> agent ++:send execution request \nwith workload list
end
loop for each other agent
    grpc_server ->> agent ++:send execution request \nwith list of workload states
end

deactivate agent
deactivate agent
deactivate server
deactivate grpc_server
deactivate grpc_server
deactivate grpc_server
deactivate tonic_server
else
server - ->> main- -: startup config error
deactivate server
main -> main++- -: Graceful shutdown
destroy tonic_server
destroy grpc_server
destroy server
destroy main
end
@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 17.0.9+9-Debian-1deb12u1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>