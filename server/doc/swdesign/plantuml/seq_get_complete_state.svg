<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="326px" preserveAspectRatio="none" style="width:946px;height:326px;" version="1.1" viewBox="0 0 946 326" width="946px" zoomAndPan="magnify"><defs/><g><rect fill="#EEEEEE" height="304.6563" style="stroke: #D3D3D3; stroke-width: 1.0;" width="726" x="14" y="4"/><text fill="#777777" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="322" y="16.0669">Ankaios Server</text><rect fill="#EEEEEE" height="304.6563" style="stroke: #D3D3D3; stroke-width: 1.0;" width="121" x="814" y="4"/><text fill="#777777" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="115" x="817" y="16.0669">Ankaios Agents</text><rect fill="#FFFFFF" height="39.6992" style="stroke: #383838; stroke-width: 1.0;" width="10" x="313" y="188.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="662.5" y="129.8594"/><rect fill="#FFFFFF" height="215.9297" style="stroke: #383838; stroke-width: 1.0;" width="10" x="869.5" y="80.7266"/><line style="stroke: #383838; stroke-width: 1.0;" x1="74" x2="74" y1="70.7266" y2="80.7266"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="74" x2="74" y1="80.7266" y2="108.7266"/><line style="stroke: #383838; stroke-width: 1.0;" x1="74" x2="74" y1="108.7266" y2="314.6563"/><line style="stroke: #383838; stroke-width: 1.0;" x1="318" x2="318" y1="70.7266" y2="80.7266"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="318" x2="318" y1="80.7266" y2="108.7266"/><line style="stroke: #383838; stroke-width: 1.0;" x1="318" x2="318" y1="108.7266" y2="314.6563"/><line style="stroke: #383838; stroke-width: 1.0;" x1="482" x2="482" y1="70.7266" y2="80.7266"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="482" x2="482" y1="80.7266" y2="108.7266"/><line style="stroke: #383838; stroke-width: 1.0;" x1="482" x2="482" y1="108.7266" y2="314.6563"/><line style="stroke: #383838; stroke-width: 1.0;" x1="667" x2="667" y1="70.7266" y2="80.7266"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="667" x2="667" y1="80.7266" y2="108.7266"/><line style="stroke: #383838; stroke-width: 1.0;" x1="667" x2="667" y1="108.7266" y2="314.6563"/><line style="stroke: #383838; stroke-width: 1.0;" x1="874" x2="874" y1="70.7266" y2="80.7266"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="874" x2="874" y1="80.7266" y2="108.7266"/><line style="stroke: #383838; stroke-width: 1.0;" x1="874" x2="874" y1="108.7266" y2="314.6563"/><rect fill="#F8F8F8" height="46.5938" style="stroke: #383838; stroke-width: 1.5;" width="112" x="18" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="27.5" y="43.1279">&lt;&lt;thread&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="25" y="59.4248">AnkaiosServer</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="94" x="271" y="39.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="278" y="59.4248">ServerState</text><rect fill="#F8F8F8" height="46.5938" style="stroke: #383838; stroke-width: 1.5;" width="214" x="375" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="435.5" y="43.1279">&lt;&lt;thread&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="200" x="382" y="59.4248">GRPCCommunicationsServer</text><rect fill="#F8F8F8" height="46.5938" style="stroke: #383838; stroke-width: 1.5;" width="137" x="599" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="621" y="43.1279">&lt;&lt;thread&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="123" x="606" y="59.4248">tonic gRPC server</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="55" x="847" y="39.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="854" y="59.4248">Agent</text><rect fill="#FFFFFF" height="39.6992" style="stroke: #383838; stroke-width: 1.0;" width="10" x="313" y="188.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="662.5" y="129.8594"/><rect fill="#FFFFFF" height="215.9297" style="stroke: #383838; stroke-width: 1.0;" width="10" x="869.5" y="80.7266"/><line style="stroke: #383838; stroke-width: 1.0;" x1="672.5" x2="682.5" y1="129.8594" y2="125.8594"/><line style="stroke: #383838; stroke-width: 1.0;" x1="672.5" x2="682.5" y1="129.8594" y2="133.8594"/><line style="stroke: #383838; stroke-width: 1.0;" x1="672.5" x2="868.5" y1="129.8594" y2="129.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="689.5" y="124.7935">RequestCompleteState</text><line style="stroke: #383838; stroke-width: 1.0;" x1="74" x2="84" y1="158.9922" y2="154.9922"/><line style="stroke: #383838; stroke-width: 1.0;" x1="74" x2="84" y1="158.9922" y2="162.9922"/><line style="stroke: #383838; stroke-width: 1.0;" x1="74" x2="666.5" y1="158.9922" y2="158.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="91" y="153.9263">RequestCompleteState</text><polygon fill="#383838" points="301,184.125,311,188.125,301,192.125" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="74" x2="307" y1="188.125" y2="188.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="220" x="81" y="183.0591">filter CompleteState by field_mask</text><line style="stroke: #383838; stroke-width: 1.0;" x1="74" x2="84" y1="227.8242" y2="223.8242"/><line style="stroke: #383838; stroke-width: 1.0;" x1="74" x2="84" y1="227.8242" y2="231.8242"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="74" x2="317" y1="227.8242" y2="227.8242"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="91" y="222.7583">CompleteState</text><path d="M328,201.125 L328,241.125 L570,241.125 L570,211.125 L560,201.125 L328,201.125 " fill="#FFFFFF" style="stroke: #383838; stroke-width: 1.0;"/><path d="M560,201.125 L560,211.125 L570,211.125 L560,201.125 " fill="#FFFFFF" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="334" y="218.1919">If field_mask is empty</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="221" x="334" y="233.3247">the full CompleteState is returned.</text><line style="stroke: #383838; stroke-width: 1.0;" x1="480" x2="470" y1="267.5234" y2="263.5234"/><line style="stroke: #383838; stroke-width: 1.0;" x1="480" x2="470" y1="267.5234" y2="271.5234"/><line style="stroke: #383838; stroke-width: 1.0;" x1="74" x2="481" y1="267.5234" y2="267.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="81" y="262.4575">CompleteState</text><line style="stroke: #383838; stroke-width: 1.0;" x1="872.5" x2="862.5" y1="296.6563" y2="292.6563"/><line style="stroke: #383838; stroke-width: 1.0;" x1="872.5" x2="862.5" y1="296.6563" y2="300.6563"/><line style="stroke: #383838; stroke-width: 1.0;" x1="482" x2="873.5" y1="296.6563" y2="296.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="489" y="291.5903">CompleteState</text><!--MD5=[b49211f70a2e8d673f53d85c6ed6bdd9]
@startuml seq_get_complete_state
skinparam monochrome true
skinparam guillemet true
skinparam style strictuml
hide empty members
hide empty methods

skinparam class {
    BorderColor<<logical entity>> grey
    FontColor<<logical entity>> grey
    StereotypeFontColor<<logical entity>> grey
}

skinparam sequenceBox {
    BorderColor #LightGrey
    BackgroundColor #EEEEEE
    FontColor #777777
}

skinparam BoxPadding 10

skinparam note {
    BackgroundColor #FFFFFF
}

skinparam nodesep 30
skinparam ranksep 30

box "Ankaios Server"
participant "<<thread>>\nAnkaiosServer" as server
participant "ServerState" as server_state
participant "<<thread>>\nGRPCCommunicationsServer" as grpc_server
participant "<<thread>>\ntonic gRPC server" as tonic_server
end box


box "Ankaios Agents"
participant "Agent" as agent
end box

activate agent

...
agent ->> tonic_server++: RequestCompleteState
tonic_server ->> server- -++: RequestCompleteState
server -> server_state++: filter CompleteState by field_mask
server_state - ->> server- -: CompleteState
note right
If field_mask is empty
the full CompleteState is returned.
end note
server ->> grpc_server- -++: CompleteState
grpc_server ->> agent- -: CompleteState
deactivate agent



@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 17.0.9+9-Debian-1deb12u1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>